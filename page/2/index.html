<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.isroots.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="记录一些自己的见闻">
<meta property="og:type" content="website">
<meta property="og:title" content="吴晓宁blog">
<meta property="og:url" content="https://blog.isroots.com/page/2/index.html">
<meta property="og:site_name" content="吴晓宁blog">
<meta property="og:description" content="记录一些自己的见闻">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="吴晓宁">
<meta property="article:tag" content="blog">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://blog.isroots.com/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>吴晓宁blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">吴晓宁blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">吴晓宁blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.isroots.com/2024/07/22/netstatus%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="吴晓宁">
      <meta itemprop="description" content="记录一些自己的见闻">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吴晓宁blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/07/22/netstatus%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-07-22 14:40:30" itemprop="dateCreated datePublished" datetime="2024-07-22T14:40:30+08:00">2024-07-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="netstatus命令使用"><a href="#netstatus命令使用" class="headerlink" title="netstatus命令使用"></a>netstatus命令使用</h1><h2 id="netstatus-命令总结"><a href="#netstatus-命令总结" class="headerlink" title="netstatus 命令总结"></a>netstatus 命令总结</h2><p>netstatus 命令是一个用于查看网络连接状态的命令，主要用于诊断网络问题。以下是 netstatus 命令的一些常用选项和用法：</p>
<p>NaN. netstat -a：显示所有连接和监听端口的状态。</p>
<p>NaN. netstat -n：以数字形式显示地址和端口号。</p>
<p>NaN. netstat -p：显示与每个连接关联的进程 ID 和名称。</p>
<p>NaN. netstat -r：显示路由表。</p>
<p>NaN. netstat -s：显示各种协议的统计信息。</p>
<p>NaN. netstat -t：显示 TCP 连接状态。</p>
<p>NaN. netstat -u：显示 UDP 连接状态。</p>
<p>NaN. netstat -c：连续显示连接状态。</p>
<p>NaN. netstat -l：显示正在监听的端口。</p>
<p>NaN. netstat -o：显示与每个连接关联的进程 ID 和名称，以及占用的 CPU 时间。</p>
<p>总之，netstatus 命令是一个非常有用的网络工具，可以帮助用户快速诊断网络问题，定位连接问题，并了解网络连接的状态。</p>
<h2 id="详细说明"><a href="#详细说明" class="headerlink" title="详细说明"></a>详细说明</h2><p>netstat（network statistics）是一个用于显示网络连接状态的命令行工具，可用于诊断网络问题。它可以显示当前正在运行的 TCP&#x2F;IP 协议的连接状态、路由表、网络接口和多播成员等信息。以下是 netstat 命令的一些常用选项和用法：</p>
<p>NaN. netstat -a：显示所有连接和监听端口的状态。这个选项可以列出所有正在运行的 TCP 和 UDP 连接，以及正在监听的端口。</p>
<p>NaN. netstat -n：以数字形式显示地址和端口号。这个选项将不会把地址和端口号解析为主机名和服务名，而是直接显示数字格式。</p>
<p>NaN. netstat -p：显示与每个连接关联的进程 ID 和名称。这个选项可以显示每个连接所属的进程 ID 和名称，以及该进程的状态。</p>
<p>NaN. netstat -r：显示路由表。这个选项可以显示当前系统的路由表，包括默认网关和直接连接的网络。</p>
<p>NaN. netstat -s：显示各种协议的统计信息。这个选项可以显示各种协议的统计信息，包括 TCP、UDP、ICMP 等。</p>
<p>NaN. netstat -t：显示 TCP 连接状态。这个选项可以显示当前所有 TCP 连接的状态，包括 ESTABLISHED、CLOSE_WAIT、TIME_WAIT 等。</p>
<p>NaN. netstat -u：显示 UDP 连接状态。这个选项可以显示当前所有 UDP 连接的状态，包括 LISTENING、CLOSED 等。</p>
<p>NaN. netstat -c：连续显示连接状态。这个选项可以连续显示连接状态，每隔一秒钟刷新一次。</p>
<p>NaN. netstat -l：显示正在监听的端口。这个选项可以显示当前系统中所有正在监听的端口。</p>
<p>NaN. netstat -o：显示与每个连接关联的进程 ID 和名称，以及占用的 CPU 时间。这个选项可以显示每个连接所属的进程 ID 和名称，以及该进程所占用的 CPU 时间。</p>
<p>总之，netstat 命令是一个非常有用的网络工具，可以帮助用户快速诊断网络问题，定位连接问题，并了解网络连接的状态。熟练掌握 netstat 命令的用法，可以更好地管理和维护网络系统。</p>
<h2 id="netstat-安装"><a href="#netstat-安装" class="headerlink" title="netstat 安装"></a>netstat 安装</h2><p>在大多数 Linux 发行版中，<code>netstat</code> 命令通常是预装的，无需手动安装。但是，在某些基于 Alpine Linux 的 Docker 镜像中可能需要手动安装。</p>
<p>如果你需要手动安装 <code>netstat</code> 命令，可以按照以下步骤进行：</p>
<p>NaN. 打开终端，以 root 用户身份登录系统。</p>
<p>NaN. 使用以下命令安装 <code>net-tools</code> 包：</p>
<pre><code>- Debian/Ubuntu 系统：
    
    <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get install net-tools</span><br></pre></td></tr></table></figure>
    
- CentOS/RHEL 系统：
    
    <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum update</span><br><span class="line">yum install net-tools</span><br></pre></td></tr></table></figure>
    
</code></pre>
<p>NaN. 安装完成后，可以在终端中输入 <code>netstat -h</code> 命令来查看 <code>netstat</code> 命令的帮助文档，以确认安装是否成功。</p>
<p>注意，在一些新的 Linux 发行版中，<code>netstat</code> 命令已经被废弃，建议使用更现代化的 <code>ss</code> 命令来代替。<code>ss</code> 命令的用法与 <code>netstat</code> 类似，但是更加高效和准确。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.isroots.com/2024/07/22/log4qt%20for%20Qt5%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="吴晓宁">
      <meta itemprop="description" content="记录一些自己的见闻">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吴晓宁blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/07/22/log4qt%20for%20Qt5%E4%BD%BF%E7%94%A8/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-07-22 14:40:30" itemprop="dateCreated datePublished" datetime="2024-07-22T14:40:30+08:00">2024-07-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="下载-log4qt"><a href="#下载-log4qt" class="headerlink" title="下载 log4qt"></a>下载 log4qt</h2><p>从github 上下载log4qt的最新源码，在下载的时候需要注意自己使用的Qt版本，如果Qt是低于5.3版本的，请下载这个 <a target="_blank" rel="noopener" href="https://github.com/MEONMedical/Log4Qt/tree/master" title="qt低于5.3版本">qt低于5.3版本</a>如果高于5.3版本的请直接下载<a target="_blank" rel="noopener" href="https://github.com/MEONMedical/Log4Qt/tree/1.4" title="地址">地址</a></p>
<h2 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h2><p>编译非常方便，我是直接使用qtCreator打开目录下Log4Qt&#x2F;log4qt.pro 进行编译的，如果编译过程中有版本判定的错误之类的，修改判断即可</p>
<p>使用qtCreator编译会将.lib和.dll的直接编译出来，我QtCreator配置的编译器msvc2013.生成的目录在Log4Qt&#x2F;bin 目录下</p>
<ul>
<li>在编译32位的库的时候,遇到了提示 <code>error C3861: “__builtin_popcount”: 找不到标识符</code>和<code>error C3861: “__builtin_popcountll”: 找不到标识符</code>.在那个错误的头文件添加</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#define __builtin_popcount __popcnt </span><br><span class="line">#define __builtin_popcountl __popcnt</span><br><span class="line">#define __builtin_popcountll __popcnt</span><br><span class="line">#define __builtin_popcountlll __popcnt</span><br></pre></td></tr></table></figure>

<h2 id="使用log4qt"><a href="#使用log4qt" class="headerlink" title="使用log4qt"></a>使用log4qt</h2><ul>
<li><p>在自己的工程中使用log4Qt,直接将Log4Qt&#x2F;src 目录拷贝到自己的工程目录，在自己工程目录的pro文件添加<code>INCLUDEPATH += ./src</code>，将Log4Qt&#x2F;bin下的log4qt.dll 和 log4qt.lib拷贝到自己工程目录下，载pro文件增加<code>unix|win32: LIBS += -L$$PWD/ -llog4qt</code>。</p>
</li>
<li><p>参考Log4Qt\examples\propertyconfigurator 中的使用方式，将<code>propertyconfigurator.exe.log4qt.properties</code> 文件拷贝自己程序生成目录中，将<code>propertyconfigurator.exe</code>修改成为自己的应用程序名称.</p>
</li>
<li><p>在工程文件中增加一个新的日志类，我这里为了方便将新的日志类写成了单例模式,具体代码参考</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">loggerFile.h</span><br><span class="line">#ifndef LOGGERFILE_H</span><br><span class="line">#define LOGGERFILE_H</span><br><span class="line"></span><br><span class="line">#include &lt;QObject&gt;</span><br><span class="line">#include &quot;log4qt/logger.h&quot;</span><br><span class="line"></span><br><span class="line">class loggerFile : public QObject</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line">public:</span><br><span class="line">    static loggerFile* getLoggerFile();</span><br><span class="line"></span><br><span class="line">    virtual ~loggerFile();</span><br><span class="line"></span><br><span class="line">    void initLoggerFile();</span><br><span class="line"></span><br><span class="line">    void loggerInfo(const QString&amp; string);</span><br><span class="line"></span><br><span class="line">    void loggerWarning(const QString&amp; string);</span><br><span class="line"></span><br><span class="line">    void loggerError(const QString&amp; string);</span><br><span class="line"></span><br><span class="line">    void loggerDebug(const QString&amp; string);</span><br><span class="line"></span><br><span class="line">    void loggerExit();</span><br><span class="line">signals:</span><br><span class="line"></span><br><span class="line">public slots:</span><br><span class="line"></span><br><span class="line">private:</span><br><span class="line">    explicit loggerFile(QObject *parent = 0);</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line">#endif // LOGGERFILE_H</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">loggerFile.cpp</span><br><span class="line">#include &lt;QCoreApplication&gt;</span><br><span class="line">#include &quot;log4qt/propertyconfigurator.h&quot;</span><br><span class="line">#include &quot;log4qt/loggerrepository.h&quot;</span><br><span class="line">#include &lt;QScopedPointer&gt;</span><br><span class="line">#include &lt;QStringBuilder&gt;</span><br><span class="line">#include &lt;QString&gt;</span><br><span class="line">#include &lt;QFile&gt;</span><br><span class="line">#include &lt;QDebug&gt;</span><br><span class="line">#include &lt;QDateTime&gt;</span><br><span class="line">#include &quot;loggerFile.h&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">using namespace Log4Qt;</span><br><span class="line">loggerFile *loggerFile::getLoggerFile()</span><br><span class="line">&#123;</span><br><span class="line">    static loggerFile *m_loggerFile;</span><br><span class="line">    if(m_loggerFile == nullptr)</span><br><span class="line">    &#123;</span><br><span class="line">        m_loggerFile = new loggerFile();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return m_loggerFile;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">loggerFile::~loggerFile()</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void loggerFile::initLoggerFile()</span><br><span class="line">&#123;</span><br><span class="line">    QString configFile = QCoreApplication::applicationFilePath() + QStringLiteral(&quot;.log4qt.properties&quot;);</span><br><span class="line">    if (QFile::exists(configFile))</span><br><span class="line">    &#123;</span><br><span class="line">        Log4Qt::PropertyConfigurator::configureAndWatch(configFile);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void loggerFile::loggerInfo(const QString &amp;string)</span><br><span class="line">&#123;</span><br><span class="line">    auto logger = Log4Qt::Logger::rootLogger();</span><br><span class="line"></span><br><span class="line">    logger-&gt;info(string);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void loggerFile::loggerWarning(const QString &amp;string)</span><br><span class="line">&#123;</span><br><span class="line">    auto logger = Log4Qt::Logger::rootLogger();</span><br><span class="line"></span><br><span class="line">    logger-&gt;warn(string);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void loggerFile::loggerError(const QString &amp;string)</span><br><span class="line">&#123;</span><br><span class="line">    auto logger = Log4Qt::Logger::rootLogger();</span><br><span class="line"></span><br><span class="line">    logger-&gt;error(string);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void loggerFile::loggerDebug(const QString &amp;string)</span><br><span class="line">&#123;</span><br><span class="line">    auto logger = Log4Qt::Logger::rootLogger();</span><br><span class="line"></span><br><span class="line">    logger-&gt;debug(string);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void loggerFile::loggerExit()</span><br><span class="line">&#123;</span><br><span class="line">        auto logger = Log4Qt::Logger::rootLogger();</span><br><span class="line"></span><br><span class="line">        logger-&gt;info(&quot;#####################################################################&quot;);</span><br><span class="line">        logger-&gt;info(QString(&quot;#                EXIT TIME=%1              #&quot;).arg(QDateTime::currentDateTime().toString()));</span><br><span class="line">        logger-&gt;info(&quot;#####################################################################&quot;);</span><br><span class="line">        logger-&gt;removeAllAppenders();</span><br><span class="line">        logger-&gt;loggerRepository()-&gt;shutdown();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">loggerFile::loggerFile(QObject *parent) :</span><br><span class="line">    QObject(parent)</span><br><span class="line">&#123;</span><br><span class="line">    initLoggerFile();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在别的模块中使用的时候包含<code>loggerFile.h</code> 头文件，然后直接调用即可<code>loggerFile::getLoggerFile()-&gt;loggerError(QString(&quot;error&quot;));</code></p>
<p>在main函数中调用<code>loggerFile::getLoggerFile()-&gt;loggerExit();</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">main.cpp</span><br><span class="line">int main(int argc, char *argv[])</span><br><span class="line">&#123;</span><br><span class="line">    QApplication app(argc, argv);</span><br><span class="line"></span><br><span class="line">    int ret=app.exec();</span><br><span class="line">    loggerFile::getLoggerFile()-&gt;loggerExit();</span><br><span class="line">    return ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.isroots.com/2024/07/22/macos%20%E7%BC%96%E8%AF%91Boost%20%E9%94%99%E8%AF%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="吴晓宁">
      <meta itemprop="description" content="记录一些自己的见闻">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吴晓宁blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/07/22/macos%20%E7%BC%96%E8%AF%91Boost%20%E9%94%99%E8%AF%AF/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-07-22 14:40:30" itemprop="dateCreated datePublished" datetime="2024-07-22T14:40:30+08:00">2024-07-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="相关版本"><a href="#相关版本" class="headerlink" title="相关版本"></a>相关版本</h2><ul>
<li>macos 10.15.7</li>
<li>boost 1.76.0</li>
<li>Homebrew 3.2.9<br>  boost 库是使用brew 安装的最新版本</li>
</ul>
<h2 id="编译时问题"><a href="#编译时问题" class="headerlink" title="编译时问题"></a>编译时问题</h2><p>在使用cmake 编译工程的时候，使用的是静态库链接，然后<code>regex</code>库无法进行链接，动态库是可以的。cmake文件如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">cmake_minimum_required(VERSION 3.0)</span><br><span class="line">set(Boost_USE_STATIC_LIBS        ON)  # only find static libs</span><br><span class="line"></span><br><span class="line">project(test )</span><br><span class="line"></span><br><span class="line">set(BOOST_COMPONENTS date_time chrono  filesystem  regex system )</span><br><span class="line">find_package(Boost REQUIRED COMPONENTS $&#123;BOOST_COMPONENTS&#125;)</span><br><span class="line">if(Boost_FOUND )</span><br><span class="line">    MESSAGE(STATUS &quot;Boost_INCLUDE_DIRS = $&#123;Boost_INCLUDE_DIRS&#125;&quot;)</span><br><span class="line">    MESSAGE(STATUS &quot;Boost_LIBRARIES = $&#123;Boost_LIBRARIES&#125;&quot;)</span><br><span class="line">    MESSAGE(STATUS &quot;Boost_LIB_VERSION = $&#123;Boost_LIB_VERSION&#125;&quot;)</span><br><span class="line">    include_directories($&#123;Boost_INCLUDE_DIRS&#125;)</span><br><span class="line">endif()</span><br><span class="line">add_executable(test main.cpp)</span><br><span class="line">target_link_libraries(test $&#123;Boost_LIBRARIES&#125;)</span><br></pre></td></tr></table></figure>

<p>在<code>make</code>编译的时候，一直报一个链接错误。<br><a target="_blank" rel="noopener" href="https://isrootblog-1251140236.cos.ap-beijing.myqcloud.com/uPic/ajScFH.png" title="编译错误"><img src="https://isrootblog-1251140236.cos.ap-beijing.myqcloud.com/uPic/ajScFH.png" alt="编译错误" title="编译错误"></a></p>
<p>这是在静态链接的时候找不到icudata库文件。</p>
<h2 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h2><p>在cmake 文件中添加<code>set(CMAKE_CXX_FLAGS &quot;$&#123;CMAKE_CXX_FLAGS&#125; -L/usr/local/opt/icu4c/lib -I/usr/local/opt/icu4c/include&quot;)</code></p>
<p>重新编译，可以正常编译过。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.isroots.com/2024/07/22/linux%E7%BD%91%E7%BB%9CIO%E6%A8%A1%E5%9E%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="吴晓宁">
      <meta itemprop="description" content="记录一些自己的见闻">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吴晓宁blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/07/22/linux%E7%BD%91%E7%BB%9CIO%E6%A8%A1%E5%9E%8B/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-07-22 14:40:30" itemprop="dateCreated datePublished" datetime="2024-07-22T14:40:30+08:00">2024-07-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="I-O模型"><a href="#I-O模型" class="headerlink" title="I&#x2F;O模型"></a>I&#x2F;O模型</h1><h3 id="两种高效的事件处理模式"><a href="#两种高效的事件处理模式" class="headerlink" title="两种高效的事件处理模式"></a><strong>两种高效的事件处理模式</strong></h3><ul>
<li><p><strong>Reactor 模式</strong></p>
<p>  Reactor 模式要求**<em>主线程</em>**(I&#x2F;O处理单元)只负责监听文件描述上是否有事件发生，有的话就立即将该事件通知工作线程，除此之外，主线程不负责其他任何实质性的工作。以<code>epoll_wait</code>为例实现的<code>Reactor</code>模式的工作流程</p>
<p>  NaN. 主线程往<code>epoll</code>内核事件表中注册<code>socket</code>上的读就绪事件</p>
<p>  NaN. 主线程调用<code>epoll_wait</code>等待<code>socket</code>上有数据可读</p>
<p>  NaN. 当<code>socket</code>上有数据可读时，<code>epoll_wait</code>通知主线程，主线程则将<code>socket</code>可读事件放入请求队列</p>
<p>  NaN. 睡眠在请求队列上的某个工作线程被唤醒，它从<code>socket</code>读取数据，并处理客户请求，然后往<code>epoll</code> 内核事件表中注册该<code>socket</code>上的写就绪事件</p>
<p>  NaN. 主线程调用<code>epoll_wait</code>等待socket可写</p>
<p>  NaN. 当<code>socket</code>可写时，<code>epoll_wait</code>通知主线程，主线程将<code>socket</code> 可写事件放入请求队列</p>
<p>  NaN. 睡眠在请求队列上的某个工作线程被唤醒，它往<code>socket</code>上写入服务器处理客户端请求的结果</p>
<pre><code>  ![](https://isrootblog-1251140236.cos.ap-beijing.myqcloud.com/uPic/Reactormoshi_R2Y4X6mes1.png)
  
  工作线程从请求队列取出事件后，将根据事件类型进行处理，因此没有必要区分 读工作线程 和 写工作线程。
  
</code></pre>
</li>
<li><p><strong>Proactor 模式</strong></p>
<p>  Proactor 模式将所有<code>I/O</code>操作都交给 <strong>主线程</strong>和 <strong>内核</strong> 来处理，工作线程仅负责业务逻辑，</p>
<p>  使用异步<code>I/O</code> 模型（<code>aio_read</code> 和 <code>aio_write</code>）为例实现的Proactor模式的工作流程</p>
<p>  NaN. 主线程调用<code>aio_read</code>函数向内核注册<code>socket</code>上的读完成事件，并告诉内核用户读缓冲区的地址，以及读操作完成时如何通知应用程序(可以使用信号)</p>
<p>  NaN. 主线程继续处理其他逻辑</p>
<p>  NaN. 当<code>socket</code>上的数据被读入用户缓冲区后，内核将向应用程序发送一个信号，以通知应用程序数据已经可用</p>
<p>  NaN. 应用程序预先定义好的信号处理函数选择一个工作线程来处理客户请求，工作线程处理完客户请求后，调用<code>aio_write</code>函数向内核注册<code>socket</code>上的写完成事件，并告诉内核用户写缓冲区的位置，以及写操作完成时如何通知应用程序(以信号为例)</p>
<p>  NaN. 主线程继续处理其他逻辑</p>
<p>  NaN. 当用户缓冲区的数据被写入<code>socket</code>之后，内核将向应用程序发送一个信号，以通知应用程序数据已经发送完毕</p>
<p>  NaN. 应用程序预先定义好的信号处理函数选择一个工作线程来做善后处理，比如决定是否关闭<code>socket</code> Proactor 模式工作流程： <img src="https://isrootblog-1251140236.cos.ap-beijing.myqcloud.com/uPic/Proactor%E6%A8%A1%E5%BC%8F_hxiBM0rNvF.png"></p>
<p>  上图中，<code>socket</code> 上的读写事件是通过调用<code>aio_read</code> &#x2F;<code>aio_write</code>向内核注册的，因此内核也应该通过信号来向应用程序报告<code>socket</code>上的读写事件，主线程中的<code>epoll_wait</code>调用仅能用来检测监听<code>socket</code>上的连接请求事件，而不能用来检测连接<code>socket</code>上的读写事件</p>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.isroots.com/2024/07/22/kindle%20%E8%AF%BB%E4%B9%A6%E6%91%98%E6%8A%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="吴晓宁">
      <meta itemprop="description" content="记录一些自己的见闻">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吴晓宁blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/07/22/kindle%20%E8%AF%BB%E4%B9%A6%E6%91%98%E6%8A%84/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-07-22 14:40:30" itemprop="dateCreated datePublished" datetime="2024-07-22T14:40:30+08:00">2024-07-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>《对于为何要学习某种东西抱有疑问，本是理所当然。唯有疑问解除了，才会产生求知的欲望，才能走上理解数学本质之路。》(摘自由东野圭吾(Higashino Keigo), 刘子倩撰写的《嫌疑人 X 的献身》)</p>
<p>《自以为是永远都是大敌，本可看到的东西也会因此视而不见。”》(摘自由 东野圭吾(Higashino Keigo), 刘子倩 撰写的《嫌疑人X的献身》)</p>
<p>《他提到的创造性思维技巧中的一个叫作“假面具”。按照这个方法，如果你想解决一个问题，可以从它的对立面着手思考，看会有什么创意迸发出来。举个简单的例子：如果想盖一座摩天大楼，就反过来想如果造一座深入地下的建筑会怎样。这样做可以强迫大脑拓宽思路，看到更多的可能性，进而激发更多创意。》(摘自由 斯蒂芬·盖斯, 桂君 撰写的《微习惯（1天1个俯卧撑、1天读1页书……每天只做一点点的无负担习惯策略，简单到不可能失败的自我管理法则！）》)</p>
<p>《数学归纳法依赖于这样一个事实：任意一个自然数r都有一个后继的自然数r＋1，而且我们所求的自然数n可以从1开始经过这样的有限步骤而达到．》(摘自由 R·柯朗H·罗宾, I·斯图尔特, 左平, 张饴慈 撰写的《什么是数学：对思想和方法的基本研究(中文版第三版)》)</p>
<p>《大多数人如果能给更多事情一个机会的话，他们的问题都能解决。》(摘自由 加·泽文, 孙仲旭, 李玉瑶 撰写的《岛上书店（每个人的生命中，都有无比艰难的那一年，将人生变得美好而辽阔。现象级全球畅销书！） (读客全球顶级畅销小说文库 137)》)</p>
<p>《一旦一个人在乎一件事，就发现自己不得不开始在乎一切事。》(摘自由 加·泽文, 孙仲旭, 李玉瑶 撰写的《岛上书店（每个人的生命中，都有无比艰难的那一年，将人生变得美好而辽阔。现象级全球畅销书！） (读客全球顶级畅销小说文库 137)》)</p>
<p>《生活中每一桩糟糕事，几乎都是时机不当的结果，每件好事，都是时机恰到好处的结果。”》(摘自由 加·泽文, 孙仲旭, 李玉瑶 撰写的《岛上书店（每个人的生命中，都有无比艰难的那一年，将人生变得美好而辽阔。现象级全球畅销书！） (读客全球顶级畅销小说文库 137)》)</p>
<p>《然而就是因为独来独往，才让我们以为自己不值得被爱。有一天，你不知道是什么时候，你会驱车上路。有一天，你不知道是什么时候，你会遇到他（她）。你会被爱，因为你今生第一次真正不再孤单。你会选择不再孤单下去。”》(摘自由 加·泽文, 孙仲旭, 李玉瑶 撰写的《岛上书店（每个人的生命中，都有无比艰难的那一年，将人生变得美好而辽阔。现象级全球畅销书！） (读客全球顶级畅销小说文库 137)》)</p>
<p>《胆小鬼连幸福都会害怕，碰到棉花都会受伤，有时还会被幸福所伤。》(摘自由 太宰治, 烨伊 撰写的《人间失格 (太宰治灵魂深处无助的生命绝唱 献给迷茫中挣扎的人)》)</p>
<p>《“俗话说‘金钱散尽，情缘两断’。其实人们对这句话的解释是颠倒的。并不是说男人的钱一用光，就会被女人甩掉。而是说男人一旦没有钱，就会意志消沉，变得颓废窝囊，连笑都没力气》(摘自由 太宰治, 烨伊 撰写的《人间失格 (太宰治灵魂深处无助的生命绝唱 献给迷茫中挣扎的人)》)</p>
<p>《人性有多矛盾；我不知道，真诚中有多少虚伪，高尚中有多少卑鄙，或者，邪恶中有多少善良。》(摘自由 毛姆, 高更, 作家榜经典, 徐淳刚 撰写的《月亮与六便士(大星文化出品，全新未删节畅销冠军！荣获2017豆瓣阅读总榜第1名！纸质书电子书销量突破100万册 (作家榜经典文库)》)</p>
<p>《生活不过是一场混乱，充满了种种的荒谬和污秽，只能引人发笑，未免乐极生悲》(摘自由 毛姆, 高更, 作家榜经典, 徐淳刚 撰写的《月亮与六便士(大星文化出品，全新未删节畅销冠军！荣获2017豆瓣阅读总榜第1名！纸质书电子书销量突破100万册） (作家榜经典文库)》)</p>
<p>《然而就是因为独来独往，才让我们以为自己不值得被爱。有一天，你不知道是什么时候，你会驱车上路。有一天，你不知道是什么时候，你会遇到他（她）。你会被爱，因为你今生第一次真正不再孤单。你会选择不再孤单下去。”》(摘自由 加·泽文, 孙仲旭, 李玉瑶 撰写的《岛上书店（每个人的生命中，都有无比艰难的那一年，将人生变得美好而辽阔。现象级全球畅销书！） (读客全球顶级畅销小说文库 137)》)</p>
<p>《一个人内心已动，就必然心不在焉，心不在焉的人必然会失败。》(摘自由 度阴山 撰写的《知行合一王阳明(1472-1529)</p>
<p>《非要在平时有克制的能力，在自己的良知上用全功，把自己锻造成一个泰山压顶色不变，麋鹿在眼前而目不转的人，才能不动心。”》(摘自由 度阴山 撰写的《知行合一王阳明(1472-1529)</p>
<p>《你的意念所到之处，正确的就知道正确，错误的就知道错误，不可能有丝毫的隐瞒。只要你不去欺骗良知，真真切切地依循着良知去做，如此就能存善，如此就能除恶。此处是何等的稳当快乐！这些就是格物的真正秘诀，致知的实在功夫。若不仰仗这些真机，如何去格物？关于这点，我也是近年才领悟得如此清楚明白的。一开始，我还怀疑仅凭良知肯定会有不足，但经过仔细体会，自然会感觉到没有一丝缺陷。”》(摘自由 度阴山 撰写的《知行合一王阳明(1472-1529)</p>
<p>《王阳明心学认为人心中有个能分是非善恶的良知，所以人不必靠典籍，也不必靠其他外在的方面来证明，良知刹那间一发作，那就是正确答案。但千万不能有第二次发作，也就是在一件事上不要反复思考，记住你面对事情时脑海中的第一个解决方案，那就是最佳方案，这也就是真正的致良知。一个出色的军事家就应该致良知，相信自己良知的力量，按良知的指引做出决定，这样才不会疑虑和悔恨。》(摘自由 度阴山 撰写的《知行合一王阳明(1472-1529)</p>
<p>《一个拥有良知的人应该是在遇到压迫时，即使前面是刀山火海，即使屠刀架脖，即使不能成功，也要奋勇向前。这是为你的道、你的信仰、你的责任和你的良知必须付出的牺牲，这就是“杀身以成仁”和“无求生以害仁”》(摘自由 度阴山 撰写的《知行合一王阳明(1472-1529)</p>
<p>《一个人在忿怒时，就会感情用事，有时会怒得过分，就失去了心的本体。因此，有所忿怒，心必然不会中正》(摘自由 度阴山 撰写的《知行合一王阳明(1472-1529)</p>
<p>《我们最应该在根上操心，也就是光明良知，而光明良知的一个主要途径就是去事上磨炼。》(摘自由 度阴山 撰写的《知行合一王阳明(1472-1529)（读客熊猫君出品，讲述王阳明传奇，剖析知行合一无边威力。狂销50万！）》)</p>
<p>《ISO是感光度的意思，是指相机对光线的敏感程度，感光度值越高，画面越亮》(摘自由 京内网 撰写的《超简单！手机摄影技巧大全》</p>
<p>《快门速度控制着相机的进光量，快门速度越慢，进入相机的光线就越多，画面也就越亮，快门速度越快，进入相机的光线就越少，画面也就越暗。》(摘自由 京内网 撰写的《超简单！手机摄影技巧大全》)</p>
<p>《设计抽象模型和设计实现方案应该是两个独立的行为。但尽管如此，这并不意味着我们需要用不同的人手来分开处理这两部分，重要的是，开发人员必须知道自己在某个特定的时间时，自己到底是在负责抽象呢，还是负责实现？》(摘自由 Robert B. Murray, 王昕 撰写的《C++编程惯用法——高级程序员常用方法和技巧（异步图书） (C和C++实务精选)》</p>
<p>《设计抽象模型和设计实现细节应该是两个独立且相关的行为。 • 没有出现在抽象模型中的东西和出现在其中的东西一样重要。 • 如果存在疑问，先不要去考虑它。添加新的功能通常都不会有兼容性的问题，但是去除一个已有的功能则可能会导致代码失效。 • 彻底地检测和记录下设计中的关键点。 • 设计是一个迭代的过程。 • 请考虑边界条件。 • 在设计的初始阶段使用CRC卡片。》(摘自由 Robert B. Murray, 王昕 撰写的《C++编程惯用法——高级程序员常用方法和技巧（异步图书） (C和C++实务精选)》)</p>
<p>《对于缺省复制构造函数是否能够工作这个问题，我们并没有一个通用的规则。一种从经验中得到的方法就是：对那些包含指针的类要“另眼相待”。如果被指向的对象是“属于”该产生的对象，那么缺省的复制构造函数就有可能是错误的，因为它只是简单地复制了指针而不是指针所指向的对象。》(摘自由 Robert B. Murray, 王昕 撰写的《C++编程惯用法——高级程序员常用方法和技巧（异步图书） (C和C++实务精选)》)</p>
<p>《C++要求“对象的析构过程必须和其创建过程相反”》(摘自由 Robert B. Murray, 王昕 撰写的《C++编程惯用法——高级程序员常用方法和技巧（异步图书）</p>
<p>《如果确实因为某些原因，使得为类实现复制构造函数变得非常困难，那么请把它声明为私用的，并且不要为它提供任何的定义：》(摘自由 Robert B. Murray, 王昕 撰写的《C++编程惯用法——高级程序员常用方法和技巧（异步图书） (C和C++实务精选)》)</p>
<p>《批判性思维是建立在良好判断的基础上，使用恰当的评估标准对事物的真实价值进行判断和思考。》(摘自由 理查德·保罗, 琳达·埃尔德 撰写的《批判性思维工具(原书第3版)》)</p>
<p>《优秀的思考者可能是那些一直辛勤地工作、经常提问、追求重要观点、综合思考各种信息、区分地对待事物、试图在重要的思想观点之间建立联系的人》(摘自由 理查德·保罗, 琳达·埃尔德 撰写的《批判性思维工具(原书第3版)》)</p>
<p>《公正性需要我们没有偏见地对待所有相关的观点，排除个人、亲友、集体和国家的感受和利益的影响。它要求坚持良好的思维标准（如准确性、逻辑清晰、广度等），不受个人和团体利益的影响。》(摘自由 理查德·保罗, 琳达·埃尔德 撰写的《批判性思维工具(原书第3版)》)</p>
<p>《要具有思维勇气，要了解那些被社会认为是危险和荒谬的观点常常包含着一些真理，而群体普遍认同的观点也可能包含错误》(摘自由 理查德·保罗, 琳达·埃尔德 撰写的《批判性思维工具(原书第3版)》)</p>
<p>《我不会认同任何信念的内容。我只认同自己形成信念的过程。我是一个批判性思考者，我愿意检验我的信念，并且愿意放弃那些不能被证据和理性思考支持的信念。我会时刻跟随证据和推理的脚步。我的真实身份是一个批判性思考者、一个终生的学习者、一个通过建立更加合理的信念不停寻求提高自己思考水平的人。》(摘自由 理查德·保罗, 琳达·埃尔德 撰写的《批判性思维工具(原书第3版)》)</p>
<p>《当思想和行为一致的时候，我们就是思维正直的。我们做到了我们承诺的，没有表面说一套实际上却做另一套》(摘自由 理查德·保罗, 琳达·埃尔德 撰写的《批判性思维工具(原书第3版)》)</p>
<p>《当我们思维遵从的时候，我们仅仅能在“接受”的观点中进行思考；而要做到思考公正就是要拒绝不加判断的接受，没有亲自对这些观点的优缺点进行思考就不能接受这些观点。》(摘自由 理查德·保罗, 琳达·埃尔德 撰写的《批判性思维工具(原书第3版)》)</p>
<p>《你可以问自己下面的问题： ■今天哪些时候我的思维是最差的？ ■今天哪些时候我的思维是最好的？ ■我今天实际上在思考什么？ ■我解决了哪些问题？ ■我是否无谓地为一些消极的思维而感到沮丧？ ■如果我重新过这一天，我应该做出哪些改变？为什么？ ■我今天做了哪些对自己长期目标有益的事情？ ■我所做的事与自己的价值观相一致吗？ ■如果我以今天的方式生活10年，》(摘自由 理查德·保罗, 琳达·埃尔德 撰写的《批判性思维工具(原书第3版)》)</p>
<p>《每天通过回答下面的问题观察自己的自我中心：当我反思自己一天的行为时，我是否被细小的事情惹怒了？我是否说了一些失去理性的话来坚持自己的意见？我是否将自己的意愿强加给他人？当我对某种事物有强烈的情感的时候，我是否没能表达自己的意愿，以致后来愤恨自己？》(摘自由 理查德·保罗, 琳达·埃尔德 撰写的《批判性思维工具(原书第3版)》)</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.isroots.com/2024/07/22/Scoop%20%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="吴晓宁">
      <meta itemprop="description" content="记录一些自己的见闻">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吴晓宁blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/07/22/Scoop%20%E4%BD%BF%E7%94%A8/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-07-22 14:40:30" itemprop="dateCreated datePublished" datetime="2024-07-22T14:40:30+08:00">2024-07-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Scoop-使用"><a href="#Scoop-使用" class="headerlink" title="Scoop 使用"></a>Scoop 使用</h1><blockquote>
<h2 id="Excerpt"><a href="#Excerpt" class="headerlink" title="Excerpt"></a><strong>Excerpt</strong></h2><p>「一行命令」搞定软件 Windows 软件安装卸载</p>
</blockquote>
<hr>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a><strong>前言</strong></h2><p><a target="_blank" rel="noopener" href="https://p3terx.com/go/aHR0cHM6Ly9naXRodWIuY29tL2x1a2VzYW1wc29uL3Njb29w">Scoop</a> 是一个 Windows 包管理工具，类似于 Debian 的 <code>apt</code>、macOS 的 <code>homebrew</code>。它由开源社区驱动，体验可能是是目前所有 Windows 包管理工具中最好的。对开发者来说，包管理器能非常方便的部署开发环境，比如 Python 、Node.js 。而对于像博主这样的普通的计算机使用者来说，可以方便的安装一些常用软件，尤其是开源软件，免去了手动去官网下载的繁琐步骤，而且后续对软件进行升级只需要输入一行命令，非常便捷。</p>
<h2 id="环境要求"><a href="#环境要求" class="headerlink" title="环境要求"></a><strong>环境要求</strong></h2><ul>
<li><p>Windows 7 SP1 + &#x2F; Windows Server 2008+</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://p3terx.com/go/aHR0cHM6Ly9ha2EubXMvd21mNWRvd25sb2Fk">PowerShell 5</a>（或更高版本，包括 <a target="_blank" rel="noopener" href="https://p3terx.com/go/aHR0cHM6Ly9kb2NzLm1pY3Jvc29mdC5jb20vZW4tdXMvcG93ZXJzaGVsbC9zY3JpcHRpbmcvaW5zdGFsbC9pbnN0YWxsaW5nLXBvd2Vyc2hlbGwtY29yZS1vbi13aW5kb3dzP3ZpZXc9cG93ZXJzaGVsbC02">PowerShell Core</a>）和 <a target="_blank" rel="noopener" href="https://p3terx.com/go/aHR0cHM6Ly93d3cubWljcm9zb2Z0LmNvbS9uZXQvZG93bmxvYWQ">.NET Framework 4.5</a>（或更高版本）</p>
</li>
<li><p>Windows 用户名为英文（Windows 用户环境变量中路径值不支持中文字符）</p>
</li>
<li><p><strong>正常、快速</strong>的访问 GitHub 并下载资源</p>
</li>
</ul>
<p>Scoop 默认使用普通用户权限，其本体和安装的软件默认会放在 <code>%USERPROFILE%\scoop</code>(即 <code>C:\Users\用户名\scoop</code>)，使用管理员权限进行全局安装 (<code>-g</code>) 的软件在 <code>C:\ProgramData\scoop</code>。如果有自定安装路径的需求，那么要提前设置好环境变量，否则后续再改不是一件容易的事情。</p>
<ul>
<li><p>打开 PowerShell</p>
</li>
<li><p>设置用户安装路径</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$env:SCOOP=&#x27;D:\Scoop&#x27;</span><br><span class="line">[Environment]::SetEnvironmentVariable(&#x27;SCOOP&#x27;, $env:SCOOP, &#x27;User&#x27;)</span><br></pre></td></tr></table></figure>

<ul>
<li>设置全局安装路径（需要管理员权限）</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$env:SCOOP_GLOBAL=&#x27;D:\Scoop_Global&#x27;</span><br><span class="line">[Environment]::SetEnvironmentVariable(&#x27;SCOOP_GLOBAL&#x27;, $env:SCOOP_GLOBAL, &#x27;Machine&#x27;)</span><br></pre></td></tr></table></figure>

<ul>
<li>设置允许 PowerShell 执行本地脚本</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser</span><br></pre></td></tr></table></figure>

<ul>
<li>安装 Scoop</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iwr -useb get.scoop.sh | iex</span><br></pre></td></tr></table></figure>

<ul>
<li>没安装过 Git 则需要安装。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop install git</span><br></pre></td></tr></table></figure>

<h2 id="基础使用"><a href="#基础使用" class="headerlink" title="基础使用"></a><strong>基础使用</strong></h2><p>最基础的使用方法和其它包管理器类似，这里就不做赘述了，直接上命令列表：</p>
<ul>
<li><p><code>scoop search &lt;app&gt;</code> - 搜索软件</p>
</li>
<li><p><code>scoop install &lt;app&gt;</code> - 安装软件</p>
</li>
<li><p><code>scoop info &lt;app&gt;</code> - 查看软件详细信息</p>
</li>
<li><p><code>scoop list</code> - 查看已安装软件</p>
</li>
<li><p><code>scoop uninstall &lt;app&gt;</code> - 卸载软件，<code>-p</code>删除配置文件。</p>
</li>
<li><p><code>scoop update</code> - 更新 scoop 本体和软件列表</p>
</li>
<li><p><code>scoop update &lt;app&gt;</code> - 更新指定软件</p>
</li>
<li><p><code>scoop update *</code> - 更新所有已安装的软件</p>
</li>
<li><p><code>scoop checkup</code> - 检查 scoop 的问题并给出解决问题的建议</p>
</li>
<li><p><code>scoop help</code> - 查看命令列表</p>
</li>
<li><p><code>scoop help &lt;command&gt;</code> - 查看命令帮助说明</p>
</li>
</ul>
<h2 id="进阶使用"><a href="#进阶使用" class="headerlink" title="进阶使用"></a><strong>进阶使用</strong></h2><h3 id="添加-bucket"><a href="#添加-bucket" class="headerlink" title="添加 bucket"></a><strong>添加 bucket</strong></h3><p>所有的包管理器都会有相应的软件仓库 ，而 bucket 就是 Scoop 中的软件仓库。细心的你可能会发现 <code>scoop</code> 翻译为中文是 “舀”，而 <code>bucket</code> 是 “水桶”，所以安装软件可以理解为从水桶里舀水，似乎很形象的说。</p>
<p>Scoop 默认软件仓库（main bucket）软件数量是有限的，但是可以进行额外的添加。通过 <code>scoop bucket known</code> 命令可以查看官方认可的 bucket：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ scoop bucket known</span><br><span class="line">main</span><br><span class="line">extras</span><br><span class="line">versions</span><br><span class="line">nightlies</span><br><span class="line">nirsoft</span><br><span class="line">php</span><br><span class="line">nerd-fonts</span><br><span class="line">nonportable</span><br><span class="line">java</span><br><span class="line">games</span><br><span class="line">jetbrains</span><br></pre></td></tr></table></figure>

<p>以上官方认可的 bucket 可以通过下面这个命令直接添加：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop bucket add &lt;bucketname&gt;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://p3terx.com/go/aHR0cHM6Ly9naXRodWIuY29tL2x1a2VzYW1wc29uL3Njb29wLWV4dHJhcw">extras</a> 涵盖了大部分因为种种原因不能被收录进主仓库的常用软件，这个是强推荐添加的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop bucket add extras</span><br></pre></td></tr></table></figure>

<p>比如博主经常会使用到的写盘工具 Rufus 就在 <code>extras</code> 这个仓库中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop install rufus</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://p3terx.com/go/aHR0cHM6Ly9naXRodWIuY29tL21hdHRoZXdqYmVyZ2VyL3Njb29wLW5lcmQtZm9udHM">nerd-fonts</a> 包含了美化终端时会用到的 Powerline 字体</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop bucket add nerd-fonts</span><br></pre></td></tr></table></figure>

<p>当添加 <code>nerd-fonts</code> 仓库后可以通过以下命令搜索到所有的字体：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop search &quot;-NF&quot;</span><br></pre></td></tr></table></figure>

<p>安装字体需要使用管理员权限：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo scoop install FiraCode-NF</span><br></pre></td></tr></table></figure>

<h4 id="第三方-bucket"><a href="#第三方-bucket" class="headerlink" title="第三方 bucket"></a>第三方 bucket</h4><p>添加第三方 bucket</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop bucket add &lt;bucketname&gt; https://github.com/xxx/xxx</span><br></pre></td></tr></table></figure>

<p>从第三方 bucket 中安装软件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop install &lt;bucketname&gt;/&lt;app&gt;</span><br></pre></td></tr></table></figure>

<h3 id="清理安装包缓存"><a href="#清理安装包缓存" class="headerlink" title="清理安装包缓存"></a><strong>清理安装包缓存</strong></h3><p>Scoop 会保留下载的安装包，对于卸载后又想再安装的情况，不需要重复下载。但长期累积会占用大量的磁盘空间，如果用不到就成了垃圾。这时可以使用 <code>scoop cache</code> 命令来清理。</p>
<ul>
<li><p><code>scoop cache show</code> - 显示安装包缓存</p>
</li>
<li><p><code>scoop cache rm &lt;app&gt;</code> - 删除指定应用的安装包缓存</p>
</li>
<li><p><code>scoop cache rm *</code> - 删除所有的安装包缓存</p>
</li>
</ul>
<p>如果你不希望安装和更新软件时保留安装包缓存，可以加上 <code>-k</code> 或 <code>--no-cache</code> 选项来禁用缓存：</p>
<ul>
<li><p><code>scoop install -k &lt;app&gt;</code></p>
</li>
<li><p><code>scoop update -k *</code></p>
</li>
</ul>
<h3 id="删除旧版本软件"><a href="#删除旧版本软件" class="headerlink" title="删除旧版本软件"></a><strong>删除旧版本软件</strong></h3><p>当软件被更新后 Scoop 还会保留软件的旧版本，更新软件后可以通过 <code>scoop cleanup</code> 命令进行删除。</p>
<ul>
<li><p><code>scoop cleanup &lt;app&gt;</code> - 删除指定软件的旧版本</p>
</li>
<li><p><code>scoop cleanup *</code> - 删除所有软件的旧版本</p>
</li>
</ul>
<p>与安装软件一样，删除旧版本软件的同时也可以清理安装包缓存，同样是加上 <code>-k</code> 选项。</p>
<ul>
<li><p><code>scoop cleanup -k &lt;app&gt;</code> - 删除指定软件的旧版本并清除安装包缓存</p>
</li>
<li><p><code>scoop cleanup -k *</code> - 删除所有软件的旧版本并清除安装包缓存</p>
</li>
</ul>
<h3 id="全局安装"><a href="#全局安装" class="headerlink" title="全局安装"></a><strong>全局安装</strong></h3><p>全局安装就是给系统中的所有用户都安装，且环境变量是系统变量，对于需要设置系统变量的一些软件就需要全局安装，比如 Node.js、Python ，否则某些情况会出现无法找到命令的问题。</p>
<p>使用 <code>scoop install &lt;app&gt;</code> 命令加上 <code>-g</code> 或 <code>--global</code> 选项可对软件进行全局安装，全局安装需要管理员权限，所以需要提前以管理员权限运行的 PowerShell 。更简单的方式是先安装 <code>sudo</code>，然后用 <code>sudo</code> 命令来提权执行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scoop install sudo</span><br><span class="line">sudo scoop install -g &lt;app&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>达成在 Windows 上使用<code>sudo</code>的成就</p>
</blockquote>
<p>使用 <code>scoop list</code> 命令查看已装软件时，全局安装的软件末尾会有 <code>*global*</code> 标志。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">➜ scoop list</span><br><span class="line">Installed apps:</span><br><span class="line"></span><br><span class="line">  7zip 19.00</span><br><span class="line">  adb 30.0.0</span><br><span class="line">  aria2 1.35.0-1</span><br><span class="line">  busybox 3466-g53c09d0e1</span><br><span class="line">  CascadiaCode-NF 2.1.0 [nerd-fonts]</span><br><span class="line">  colortool 1904.29002</span><br><span class="line">  dark 3.11.2 *global*</span><br><span class="line">  ffmpeg 4.2.3</span><br><span class="line">  figlet 1.0-go</span><br><span class="line">  FiraCode-NF 2.1.0 [nerd-fonts]</span><br><span class="line">  git 2.26.2.windows.1 *global*</span><br><span class="line">  innounp 0.49</span><br><span class="line">  iperf3 3.1.3</span><br><span class="line">  lessmsi 1.6.91 *global*</span><br><span class="line">  lxrunoffline 3.4.1 [extras]</span><br><span class="line">  nano 4.9-4</span><br><span class="line">  neofetch 7.0.0</span><br><span class="line">  nodejs-lts 12.17.0 *global*</span><br><span class="line">  python 3.8.3 *global*</span><br><span class="line">  rclone 1.52.0</span><br><span class="line">  rufus 3.10 [extras]</span><br><span class="line">  screentogif 2.24.2 [extras]</span><br><span class="line">  sudo 0.2020.01.26</span><br></pre></td></tr></table></figure>

<p>此外对于全局软件的更新和卸载等其它操作，都需要加上 <code>-g</code> 选项：</p>
<ul>
<li><p><code>sudo scoop update -g *</code> - 更新所有软件（且包含全局软件）</p>
</li>
<li><p><code>sudo scoop uninstall -g &lt;app&gt;</code> - 卸载全局软件</p>
</li>
<li><p><code>sudo scoop uninstall -gp &lt;app&gt;</code> - 卸载全局软件（并删除配置文件）</p>
</li>
<li><p><code>sudo scoop cleanup -g *</code> - 删除所有全局软件的旧版本</p>
</li>
<li><p><code>sudo scoop cleanup -gk *</code> - 删除所有全局软件的旧版本（并清除安装包包缓存）</p>
</li>
</ul>
<h3 id="代理设置"><a href="#代理设置" class="headerlink" title="代理设置"></a><strong>代理设置</strong></h3><p>Scoop 默认使用的是系统代理，如果你想手动指定代理，可以输入下面的命令。需要注意的是只支持 http 协议。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop config proxy localhost:1080</span><br></pre></td></tr></table></figure>

<blockquote>
<p>设置完可以通过<code>scoop config proxy</code>查看。</p>
</blockquote>
<p>如果你想取消代理，那么输入下面的命令，这将会恢复使用系统代理。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop config rm proxy</span><br></pre></td></tr></table></figure>

<h3 id="开启多线程下载"><a href="#开启多线程下载" class="headerlink" title="开启多线程下载"></a><strong>开启多线程下载</strong></h3><p>使用 Scoop 安装 Aria2 后，Scoop 会自动调用 Aria2 进行多线程加速下载。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoop install aria2</span><br></pre></td></tr></table></figure>

<p>使用 <code>scoop config</code> 命令可以对 Aria2 进行设置，比如 <code>scoop config aria2-enabled false</code> 可以禁止调用 Aria2 下载。以下是与 Aria2 有关的设置选项：</p>
<ul>
<li><p><code>aria2-enabled</code>: 开启 Aria2 下载，默认<code>true</code></p>
</li>
<li><p><code>aria2-retry-wait</code>: 重试等待秒数，默认<code>2</code></p>
</li>
<li><p><code>aria2-split</code>: 单任务最大连接数，默认<code>5</code></p>
</li>
<li><p><code>aria2-max-connection-per-server</code>: 单服务器最大连接数，默认<code>5</code> ，最大<code>16</code></p>
</li>
<li><p><code>aria2-min-split-size</code>: 最小文件分片大小，默认<code>5M</code></p>
</li>
</ul>
<p>博主在这里推荐以下优化设置，单任务最大连接数设置为 <code>32</code>，单服务器最大连接数设置为 <code>16</code>，最小文件分片大小设置为 <code>1M</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scoop config aria2-split 32</span><br><span class="line">scoop config aria2-max-connection-per-server 16</span><br><span class="line">scoop config aria2-min-split-size 1M</span><br></pre></td></tr></table></figure>

<h2 id="常用命令总结"><a href="#常用命令总结" class="headerlink" title="常用命令总结"></a><strong>常用命令总结</strong></h2><p>看到这里一定有很多小伙伴已经懵逼了，最后总结一波 Scoop 在日常使用中的常用命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># 更新 scoop 及软件包列表</span><br><span class="line">scoop update</span><br><span class="line"></span><br><span class="line">## 安装软件 ##</span><br><span class="line"># 非全局安装（并禁止安装包缓存）</span><br><span class="line">scoop install -k &lt;app&gt;</span><br><span class="line"># 全局安装（并禁止安装包缓存）</span><br><span class="line">sudo scoop install -gk &lt;app&gt;</span><br><span class="line"></span><br><span class="line">## 卸载软件 ##</span><br><span class="line"># 卸载非全局软件（并删除配置文件）</span><br><span class="line">scoop uninstall -p &lt;app&gt;</span><br><span class="line"># 卸载全局软件（并删除配置文件）</span><br><span class="line">sudo scoop uninstall -gp &lt;app&gt;</span><br><span class="line"></span><br><span class="line">## 更新软件 ##</span><br><span class="line"># 更新所有非全局软件（并禁止安装包缓存）</span><br><span class="line">scoop update -k *</span><br><span class="line"># 更新所有软件（并禁止安装包缓存）</span><br><span class="line">sudo scoop update -gk *</span><br><span class="line"></span><br><span class="line">## 垃圾清理 ##</span><br><span class="line"># 删除所有旧版本非全局软件（并删除软件包缓存）</span><br><span class="line">scoop cleanup -k *</span><br><span class="line"># 删除所有旧版本软件（并删除软件包缓存）</span><br><span class="line">sudo scoop cleanup -gk *</span><br><span class="line"># 清除软件包缓存</span><br><span class="line">scoop cache rm *</span><br></pre></td></tr></table></figure>

<h2 id="尾巴"><a href="#尾巴" class="headerlink" title="尾巴"></a><strong>尾巴</strong></h2><p>Scoop 的使用方法和功能远不止上面提及的这些，但作为一个普通用户也只会用到一些基本的命令和功能。纵观全网也很少有人把基础功能都说明白，这也是在 0202 年咕鸽随便一搜一大把 Scoop 教程和笔记文章的情况下博主依然写这样一篇更加全面教程的原因。希望这篇教程对你有所帮助。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.isroots.com/2024/07/22/VCPKG%20%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="吴晓宁">
      <meta itemprop="description" content="记录一些自己的见闻">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吴晓宁blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/07/22/VCPKG%20%E4%BD%BF%E7%94%A8/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-07-22 14:40:30" itemprop="dateCreated datePublished" datetime="2024-07-22T14:40:30+08:00">2024-07-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="vcpkg使用"><a href="#vcpkg使用" class="headerlink" title="vcpkg使用"></a>vcpkg使用</h1><p>C++开源库 - 包管理工具Vcpkg安装使用教程</p>
<p><strong>目录</strong></p>
<ul>
<li><p><a href="#_label0">一、编译开源库的传统方法</a></p>
</li>
<li><p><a href="#_label1">二、为什么要用Vcpkg</a></p>
</li>
<li><p><a href="#_label2">三、windows下安装Vcpkg</a></p>
</li>
<li><p><a href="#_label3">四、使用Vcpkg</a></p>
<ul>
<li><p><a href="#_label3_0">4.1 查看Vcpkg支持的开源库列表</a></p>
</li>
<li><p><a href="#_label3_1">4.2 指定编译某种架构的程序库</a></p>
</li>
<li><p><a href="#_label3_2">4.3 安装一个开源库</a></p>
</li>
<li><p><a href="#_label3_3">4.4 移除一个已经安装（编译）的开源库</a></p>
</li>
<li><p><a href="#_label3_4">4.5 列出已经安装的开源库</a></p>
</li>
<li><p><a href="#_label3_5">4.6 更新已经安装的开源库</a></p>
</li>
<li><p><a href="#_label3_6">4.7 导出已经安装的开源库</a></p>
</li>
<li><p><a href="#_label3_7">4.8 导入备份的开源库</a></p>
</li>
</ul>
</li>
<li><p><a href="#_label4">五、Vcpkg和Visual Studio的集成</a></p>
<ul>
<li><p><a href="#_label4_0">5.1 什么是集成？</a></p>
</li>
<li><p><a href="#_label4_1">5.2 集成到全局</a></p>
</li>
<li><p><a href="#_label4_2">5.3. 移除全局集成</a></p>
</li>
<li><p><a href="#_label4_3">5.4 集成到工程</a></p>
</li>
<li><p><a href="#_label4_4">5.5 测试使用</a></p>
</li>
<li><p><a href="#_label4_5">5.6 集成到CMake</a></p>
</li>
<li><p><a href="#_label4_6">5.7 集成静态库</a></p>
</li>
</ul>
</li>
<li><p><a href="#_label5">六、使用Vcpkg时的注意点</a></p>
</li>
<li><p><a href="#_label6">七、小结</a></p>
</li>
</ul>
<hr>
<h2 id="一、编译开源库的传统方法"><a href="#一、编译开源库的传统方法" class="headerlink" title="一、编译开源库的传统方法"></a><strong>一、编译开源库的传统方法</strong></h2><p>Windows 下开发 C&#x2F;C++ 程序，少不了编译开源的第三方库。比如用于网络连接的高性能库 libcurl、用于压缩解压的 zlib 等等。使用这些库开发极大的方便了程序员，使得我们不必重复造轮子。但是使用这些库必须要处理以下问题。</p>
<p>编译方式 由于这些开源库绝大部分都来源于 Linux 系统，导致其工程文件、编译系统都使用 gnu 系列工具，使得将其移植到 Windows 的 VC 开发环境下一直是难点。尽管最近几年很多开源库都支持了跨平台的 CMake，但是编译过程仍然复杂和多样化。</p>
<p>常见的编译方式有：</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><strong>编译方式</strong></td>
<td><strong>特点</strong></td>
<td><strong>举例</strong></td>
</tr>
<tr>
<td>configure、make</td>
<td>需要msys这样的unix环境才可以编译</td>
<td>ffmpeg</td>
</tr>
<tr>
<td>自定义编译工具</td>
<td>需要学习特定的编译命令和工具</td>
<td>openssl、boost</td>
</tr>
<tr>
<td>cmake</td>
<td>相对简单轻松</td>
<td>libcurl</td>
</tr>
<tr>
<td>VC工程文件</td>
<td>这种最简单，直接拿来即可编译</td>
<td></td>
</tr>
</tbody></table>
<p>编译类型 当了解了这些还不够，我们还需要考虑预先编译出哪种类型的开源库程序。比如：Debug还是Release、动态库还是静态库、MD还是MT、32位还是64位。光是这三种组合就有16种可能性。如果像libcurl这种还要考虑是否引用其他开源库的功能，那么编译类型的组合会更多。管理起来很麻烦。</p>
<p>工程目录设定 由于多样的编译类型，工程目录也必须仔细设定才能保证自己的软件项目能够正常编译。</p>
<h2 id="二、为什么要用Vcpkg"><a href="#二、为什么要用Vcpkg" class="headerlink" title="二、为什么要用Vcpkg"></a><strong>二、为什么要用Vcpkg</strong></h2><p>正是由于<strong>编译开源库的传统方法</strong>的缺陷，所以出现了 <strong>Vcpkg</strong>，优点如下：</p>
<ul>
<li><p>自动下载开源库源代码。</p>
</li>
<li><p>源码包的缓存管理和版本管理，可以升级版本。</p>
</li>
<li><p>轻松编译。</p>
</li>
<li><p>依赖关系检查（比如编译 libcurl，会自动下载 zlib、openssl 进行编译）。</p>
</li>
<li><p>无缝集成 Visual Studio，不需要设置库文件、头文件的所在目录，自动集成。</p>
</li>
<li><p>Visual Studio 全平台支持，不仅支持 Debug&#x2F;Release、x86&#x2F;x64 编译，还支持 UWP、ARM 平台的编译。</p>
</li>
</ul>
<h2 id="三、windows下安装Vcpkg"><a href="#三、windows下安装Vcpkg" class="headerlink" title="三、windows下安装Vcpkg"></a><strong>三、windows下安装Vcpkg</strong></h2><p>（1）由于官方建议把 vcpkg 目录放到 <code>C:\src\</code> 下，所以先创建再移动到该目录：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cd c:/src</span><br></pre></td></tr></table></figure>

<p>（2）git 克隆官方的 git 仓库：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git clone https://github.com/microsoft/vcpkg</span><br></pre></td></tr></table></figure>

<p>（3）进入到仓库中，编译 Vcpkg：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd vcpkg</span><br><span class="line">$ ./bootstrap-vcpkg.bat</span><br></pre></td></tr></table></figure>

<p>注意：</p>
<ul>
<li><p>Vcpkg 大量使用 psl 脚本，所以官方强烈推荐使用 PowerShell 而不是 CMD 命令行来执行各种操作。尽管在使用的时候兼容 CMD，但是在编译这一步，请使用 PowerShell，以下所有操作也如此。</p>
</li>
<li><p>如果下载失败，输出 <code>Downloading vcpkg.exe failed. Please check your internet connection, ...</code>，说明外网下载不稳定，需要尝试多次下载或梯子上网。</p>
</li>
</ul>
<p>成功后输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Downloading https://github.com/microsoft/vcpkg-tool/releases/download/2021-02-24-d67989bce1043b98092ac45996a8230a059a2d7e/vcpkg.exe -&gt; C:\src\vcpkg\vcpkg.exe</span><br><span class="line">Done.</span><br></pre></td></tr></table></figure>

<p>更详细可以参考 Vcpkg 的官方 git 地址：<a target="_blank" rel="noopener" href="https://github.com/microsoft/vcpkg/blob/master/README_zh_CN.md">https://github.com/microsoft/vcpkg/blob/master/README_zh_CN.md</a></p>
<h2 id="四、使用Vcpkg"><a href="#四、使用Vcpkg" class="headerlink" title="四、使用Vcpkg"></a><strong>四、使用Vcpkg</strong></h2><h3 id="4-1-查看Vcpkg支持的开源库列表"><a href="#4-1-查看Vcpkg支持的开源库列表" class="headerlink" title="4.1 查看Vcpkg支持的开源库列表"></a><strong>4.1 查看Vcpkg支持的开源库列表</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./vcpkg.exe search</span><br></pre></td></tr></table></figure>

<p>执行命令后，两三分钟后才显示出来支持的开源库列表，基本上常用的 C++ 开源库都支持。（使用 PowerShell 执行）</p>
<h3 id="4-2-指定编译某种架构的程序库"><a href="#4-2-指定编译某种架构的程序库" class="headerlink" title="4.2 指定编译某种架构的程序库"></a><strong>4.2 指定编译某种架构的程序库</strong></h3><p>如果不指定安装的架构，vcpkg 默认把开源库编译成 x86 的 Windows 版本的库。那 vcpkg 总共支持多少种架构呢？我们可以使用如下命令便知：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./vcpkg.exe help triplet</span><br></pre></td></tr></table></figure>

<p>我们可以看到会列出如下清单：</p>
<ul>
<li><p>arm-uwp</p>
</li>
<li><p>arm-windows</p>
</li>
<li><p>arm64-uwp</p>
</li>
<li><p>arm64-windows</p>
</li>
<li><p>x64-uwp</p>
</li>
<li><p>x64-windows-static</p>
</li>
<li><p>x64-windows</p>
</li>
<li><p>x86-uwp</p>
</li>
<li><p>x86-windows-static</p>
</li>
<li><p>x86-windows</p>
</li>
</ul>
<p>这个清单以后随着版本的迭代还会再增加。vcpkg 不仅支持 x86 架构，还支持 arm 架构。注意：这里的 arm 架构特指类似于 surface 这种运行在 arm 处理器上的 Win10 平台，而并非我们传统意义上的 Linux 或 android 的 ARM 平台。</p>
<h3 id="4-3-安装一个开源库"><a href="#4-3-安装一个开源库" class="headerlink" title="4.3 安装一个开源库"></a><strong>4.3 安装一个开源库</strong></h3><p>那如果要安装编译某一个架构的开源库，我们该怎么写呢？我们只需要在需要安装的包后面指定相应的 triplet 即可。例如我们需要编译 64 位 Windows 版本的 jsoncpp，那么执行如下命令即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./vcpkg.exe install jsoncpp:x64-windows</span><br></pre></td></tr></table></figure>

<p>看到<code>Installing package jsoncpp[core]:x64-windows... done</code>，则说明安装成功。</p>
<p>如果电脑中没有安装 CMake、7zip 等软件，Vcpkg 会自动下载 portable 版本的 CMake、7zip 等软件。但是由于各种原因，下载的网速很慢，所以建议先自行下载合适版本的对应软件。最好是下载最新版本的。实际测试发现，会先同时下载以下软件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">7zip-18.1.0-windows</span><br><span class="line">cmake-3.19.2-windows</span><br><span class="line">nuget-5.5.1-windows</span><br><span class="line">powershell-core-7.1.0-windows</span><br></pre></td></tr></table></figure>

<p>报错及解决办法</p>
<p>（1）在下载 powershell 时会下载不成功，提示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Failed to download from mirror set:</span><br><span class="line">https://github.com/PowerShell/PowerShell/releases/download/v7.1.0/PowerShell-7.1.0-win-x86.zip: WinHttpSendRequest() failed: 12002</span><br></pre></td></tr></table></figure>

<p>只能复制上面下载链接，发现手动下载正常，下载完成后拷贝 <code>PowerShell-7.1.0-win-x86.zip</code> 到 <code>C:\src\vcpkg\downloads</code> 目录下，然后再执行安装指令，会跳过下载这步直接开始解压 PowerShell 压缩包。</p>
<p>遇到下载其他依赖库的压缩包失败时，也可考虑使用这种手动下载的方法。</p>
<p>后面下载 <code>jsoncpp/archive/9059f5cad030ba11d37818847443a53918c327b1.tar.gz</code> 也不成功，采用上面方法后，修改名称为 <code>open-source-parsers-jsoncpp-9059f5cad030ba11d37818847443a53918c327b1.tar.gz</code>。</p>
<p>（2）缺少英文语言包，报错：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Warning: The following VS instances are excluded because the English language pack is unavailable.</span><br></pre></td></tr></table></figure>

<p>解决办法：到 VS 安装向导，修改安装，点语言包，勾选英语；安装即可。</p>
<h3 id="4-4-移除一个已经安装（编译）的开源库"><a href="#4-4-移除一个已经安装（编译）的开源库" class="headerlink" title="4.4 移除一个已经安装（编译）的开源库"></a><strong>4.4 移除一个已经安装（编译）的开源库</strong></h3><p>如果移除一个已经安装的开源库，那么执行 remove 指令即可。比如我们要移除 jsoncpp，那么执行命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./vcpkg.exe remove jsoncpp</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong></p>
<p>这个时候只是移除了默认的 x86-winodws 版本的文件，如果有其他平台的版本需要移除，需要制定相应的 triplet。移除也只是移除了二进制程序库而已，源码包和解压缩的源码并没有删除。</p>
<p>如果想要一键移除“过时”的包，执行命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./vcpkg.exe remove --outdated</span><br></pre></td></tr></table></figure>

<h3 id="4-5-列出已经安装的开源库"><a href="#4-5-列出已经安装的开源库" class="headerlink" title="4.5 列出已经安装的开源库"></a><strong>4.5 列出已经安装的开源库</strong></h3><p>执行 list 指令即可，例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./vcpkg.exe list</span><br></pre></td></tr></table></figure>

<p>假如前面安装了 jsoncpp，会输出：<code>jsoncpp:x64-windows 1.9.4 jsoncpp is an implementation of a JSON reader an...</code></p>
<h3 id="4-6-更新已经安装的开源库"><a href="#4-6-更新已经安装的开源库" class="headerlink" title="4.6 更新已经安装的开源库"></a><strong>4.6 更新已经安装的开源库</strong></h3><p>一般有两种更新方式。一个是 update 指令，可以显示可以升级的开源库的列表。另一个是 upgrade 的指令，会重新编译所有需要更新的包。</p>
<h3 id="4-7-导出已经安装的开源库"><a href="#4-7-导出已经安装的开源库" class="headerlink" title="4.7 导出已经安装的开源库"></a><strong>4.7 导出已经安装的开源库</strong></h3><p>有的时候，一个项目组中有很多人，不需要每个人都参与编译。一个人编译好所有开源库后到处给别人即可。有的时候也是出于备份的目的，也会导出已经安装的开源库。导出可以执行 export 指令。例如，我要导出 jsoncpp 库，那么执行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./vcpkg.exe export jsoncpp --zip</span><br></pre></td></tr></table></figure>

<p>注意，导出时必须指定导出的包格式。vcpkg 支持 5 种导出包格式，有：</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><strong>参数</strong></td>
<td><strong>格式</strong></td>
</tr>
<tr>
<td>–raw</td>
<td>以不打包的目录格式导出</td>
</tr>
<tr>
<td>–nuget</td>
<td>以 nuget 包形式导出</td>
</tr>
<tr>
<td>–ifw</td>
<td>我也不知道这是啥格式</td>
</tr>
<tr>
<td>–zip</td>
<td>以 zip 压缩包形式导出</td>
</tr>
<tr>
<td>–7zip</td>
<td>以 7z 压缩包形式导出</td>
</tr>
</tbody></table>
<p>一般地，导出包的格式为：<code>vcpkg-export-&lt;日期&gt;-&lt;时间&gt;</code></p>
<p>默认情况下只会导出 x86-windows 的包，如果要导出所有包，那需要制定相应的 triplet。比如，如果同时导出 x86 和 x64 版本的 jsoncpp，那执行命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./vcpkg.exe export jsoncpp:x86-windows jsoncpp:x64-windows --zip</span><br></pre></td></tr></table></figure>

<p>如果要指定输出目录和特定文件名，需使用 “–output&#x3D;” 参数。</p>
<h3 id="4-8-导入备份的开源库"><a href="#4-8-导入备份的开源库" class="headerlink" title="4.8 导入备份的开源库"></a><strong>4.8 导入备份的开源库</strong></h3><p>导入比较简单，执行 import 指令即可。例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./vcpkg.exe import xxx.7z</span><br></pre></td></tr></table></figure>

<h2 id="五、Vcpkg和Visual-Studio的集成"><a href="#五、Vcpkg和Visual-Studio的集成" class="headerlink" title="五、Vcpkg和Visual Studio的集成"></a><strong>五、Vcpkg和Visual Studio的集成</strong></h2><h3 id="5-1-什么是集成？"><a href="#5-1-什么是集成？" class="headerlink" title="5.1 什么是集成？"></a><strong>5.1 什么是集成？</strong></h3><p>上面我们已经安装了一些第三方库，那如何使用呢？常规情况下，我们需要设置 include 目录、lib 目录等，会有很多工作量。Vcpkg 提供了一套机制，可以全自动的适配目录，而开发者不需要关心已安装的库的目录在哪里，也不需要设置。这是 Vcpkg 的一大优势。</p>
<h3 id="5-2-集成到全局"><a href="#5-2-集成到全局" class="headerlink" title="5.2 集成到全局"></a><strong>5.2 集成到全局</strong></h3><p>“集成到全局” 适用于 Visual Studio 开发环境和 msbuild 命令行。执行命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./vcpkg.exe integrate install</span><br></pre></td></tr></table></figure>

<p>当出现 <code>Applied user-wide integration for this vcpkg root.</code> 字样的时候，说明已经集成成功。这时候可以在任意的工程中使用安装好的第三方库。</p>
<h3 id="5-3-移除全局集成"><a href="#5-3-移除全局集成" class="headerlink" title="5.3. 移除全局集成"></a><strong>5.3. 移除全局集成</strong></h3><p>移除全局集成只要执行下列命令即可：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./vcpkg.exe integrate remove</span><br></pre></td></tr></table></figure>

<h3 id="5-4-集成到工程"><a href="#5-4-集成到工程" class="headerlink" title="5.4 集成到工程"></a><strong>5.4 集成到工程</strong></h3><p>上面已经可以集成到全局，为什么还要 “集成到工程” 呢？因为在大部分情况下，我们不希望集成到全局，毕竟有很多第三方库我们希望自定义处理一下，或者干脆不想集成第三方库。那么集成到工程是最灵活的处理方式。也是工程级项目推荐的处理方式。</p>
<p>“集成到工程” 是整个 vcpkg 中最复杂的一项，它需要利用 Visual Studio 中的 nuget 插件来实现。我们接下来一步一步来说。</p>
<ol>
<li>生成配置</li>
</ol>
<p>执行命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./vcpkg.exe integrate project</span><br></pre></td></tr></table></figure>

<p>这时候会在 <code>&lt;vcpkg_dir&gt;\scripts\buildsystems</code> 目录下，生成 nuget 配置文件。其中 <code>&lt;vcpkg_dir&gt;</code> 是指 vcpkg 实际所在目录。</p>
<ol start="2">
<li>基本配置</li>
</ol>
<p>打开 Visual Studio，点击菜单工具 -&gt; NuGet 包管理器 -&gt; 程序包管理器设置”，进入设置界面，点击 “程序包源”。</p>
<p>点击 “加号” 增加一个源。修改源的名字为 vcpkg。在“源”的选项中点击右侧的 “…” 选择 vcpkg 目录下的 “scripts\buildsystems” 目录，然后点击右侧的“更新按钮”。点击 “确定”，关闭设置对话框。</p>
<p>到此，全局性的设置已经完成，以后不必再重复设置了。</p>
<ol start="3">
<li>工程配置 用 Visual Studio 打开一个工程或解决方案。右键点击需要设置的工程，选择 “管理NuGet程序包”。在右上角的 “程序包源” 中选择刚刚设置的 “vcpkg”。这样在 “浏览” 选项卡中就可以看到 “vcpkg.H.Repos.vcpkg”。点击最右侧的 “安装”。这样就可以集成到某个工程了。</li>
</ol>
<h3 id="5-5-测试使用"><a href="#5-5-测试使用" class="headerlink" title="5.5 测试使用"></a><strong>5.5 测试使用</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;fstream&gt;</span><br><span class="line">#include &lt;cassert&gt;</span><br><span class="line">#include &quot;json/json.h&quot; // 直接就可以include，无需额外配置</span><br><span class="line"></span><br><span class="line">std::string createJson(void)</span><br><span class="line">&#123;</span><br><span class="line">    std::string jsonStr;</span><br><span class="line">    Json::Value root;</span><br><span class="line">    Json::StreamWriterBuilder writerBuilder;</span><br><span class="line">    std::ostringstream os;</span><br><span class="line">    // 设置默认无格式化的输出</span><br><span class="line">    writerBuilder.settings_[&quot;indentation&quot;] = &quot;&quot;;</span><br><span class="line">    root[&quot;Name&quot;] = &quot;Zhangsan&quot;;</span><br><span class="line">    root[&quot;Age&quot;] = 25;</span><br><span class="line">    // jsonWriter是智能指针, 当jsonWriter被析构时, 它所指向的对象(内存)也被自动释放</span><br><span class="line">    std::unique_ptr&lt;Json::StreamWriter&gt; jsonWriter(writerBuilder.newStreamWriter());</span><br><span class="line">    jsonWriter-&gt;write(root, &amp;os);</span><br><span class="line">    jsonStr = os.str();</span><br><span class="line"></span><br><span class="line">    return jsonStr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void saveJsonStringToFile(const char* file, std::string&amp; jsonStr)</span><br><span class="line">&#123;</span><br><span class="line">    std::ofstream ofs;</span><br><span class="line">    ofs.open(file);</span><br><span class="line">    assert(ofs.is_open());</span><br><span class="line">    ofs &lt;&lt; jsonStr;</span><br><span class="line">    ofs.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    std::string jsonStr;</span><br><span class="line">    jsonStr = createJson();</span><br><span class="line">    saveJsonStringToFile(&quot;./test.json&quot;, jsonStr);</span><br><span class="line"></span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>jsoncpp 的更多使用请参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/cfl927096306/article/details/105102843/">新版jsoncpp的一些基本用法</a></p>
<p>到此，就可以在 VS 上随意使用 jsoncpp 库了，在 exe 生成目录下也发现了 <code>jsoncpp.dll</code>。</p>
<h3 id="5-6-集成到CMake"><a href="#5-6-集成到CMake" class="headerlink" title="5.6 集成到CMake"></a><strong>5.6 集成到CMake</strong></h3><p>最新的 Visual Studio 2015、2017 和 2019 大力支持 CMake 工程，所以对 cmake 的支持当然不能少。在 cmake 中集成只要在 cmake 文件中加入下面这句话即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-DCMAKE_TOOLCHAIN_FILE=&lt;vcpkg_dir&gt;/scripts/buildsystems/vcpkg.cmake</span><br></pre></td></tr></table></figure>

<p>其中 <code>&lt;vcpkg_dir&gt;</code> 是指 vcpkg 实际所在目录。</p>
<h3 id="5-7-集成静态库"><a href="#5-7-集成静态库" class="headerlink" title="5.7 集成静态库"></a><strong>5.7 集成静态库</strong></h3><p>Vcpkg 默认编译链接的是动态库，如果要链接静态库，目前还没有简便的方法。需要做如下操作</p>
<p>NaN. 用文本方式打开 vcxproj 工程文件。</p>
<p>NaN. 在 xml 的段里面增加如下两句话即可：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;VcpkgTriplet&gt;x86-windows-static&lt;/VcpkgTriplet&gt;</span><br><span class="line">&lt;VcpkgEnabled&gt;true&lt;/VcpkgEnabled&gt;</span><br></pre></td></tr></table></figure>

<p>在 CMake 中集成静态库，需要额外指令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake .. -DCMAKE_TOOLCHAIN_FILE=.../vcpkg.cmake -DVCPKG_TARGET_TRIPLET=x86-windows-static</span><br></pre></td></tr></table></figure>

<h2 id="六、使用Vcpkg时的注意点"><a href="#六、使用Vcpkg时的注意点" class="headerlink" title="六、使用Vcpkg时的注意点"></a><strong>六、使用Vcpkg时的注意点</strong></h2><ul>
<li><p>Vcpkg 仅支持 Visual Studio 2015 update 3 及以上版本，究其原因，很可能和 C++11 的支持度以及集成原理有关系。</p>
</li>
<li><p>目前 Vcpkg 编译静态库，默认只支持 MT 模式。</p>
</li>
</ul>
<h2 id="七、小结"><a href="#七、小结" class="headerlink" title="七、小结"></a><strong>七、小结</strong></h2><p>Vcpkg 目前还在不断的完善中，但不可否认，它已经极大的减少了我们在项目启动时，准备第三方库的时间。提高了工作效率。按照时髦的话来说，就是避免了重复造轮子。目前 Vcpkg 已经集成了上百个常用的开源库，而且数量还在不停增长。毕竟是微软旗下的开源项目，质量还是可以得到保障的，完全可以在工业级项目中得以使用。源代码托管在 github上，github 社区很活跃，有兴趣的朋友也可以参与进来。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.isroots.com/2024/07/22/Qt%E8%8E%B7%E5%8F%96windows%20%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90%E7%9A%84%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="吴晓宁">
      <meta itemprop="description" content="记录一些自己的见闻">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吴晓宁blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/07/22/Qt%E8%8E%B7%E5%8F%96windows%20%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90%E7%9A%84%E6%96%B9%E6%B3%95/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-07-22 14:40:30" itemprop="dateCreated datePublished" datetime="2024-07-22T14:40:30+08:00">2024-07-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>[[QT(qt)常见问题]]</p>
<h2 id="关注这个问题的原因"><a href="#关注这个问题的原因" class="headerlink" title="关注这个问题的原因"></a>关注这个问题的原因</h2><ul>
<li>在最新做的项目中，程序自动生成的日志文件在自己的电脑上可以生成，但到了我一同事的机器上就无法生成，查看打印发现是提示权限不够。</li>
</ul>
<h2 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h2><ul>
<li><p>如果你的qtCreator配置的MSVC的编译器，直接在.por文件中添加 <code>QMAKE_LFLAGS += /MANIFESTUAC:\&quot;level=\&#39;requireAdministrator\&#39; uiAccess=\&#39;false\&#39;\&quot;</code><br>  重新编译，在需要获取的权限的系统中你的软件右下角会有个类似小盾牌一样的图片</p>
</li>
<li><p>如果你的qtCreator配置的是mingw32版本，则需要新建一个文件，名字为uac.manifest，文件内容如下:</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&#x27;1.0&#x27; encoding=&#x27;UTF-8&#x27; standalone=&#x27;yes&#x27;?&gt;</span><br><span class="line">&lt;assembly xmlns=&#x27;urn:schemas-microsoft-com:asm.v1&#x27; manifestVersion=&#x27;1.0&#x27;&gt;</span><br><span class="line">  &lt;trustInfo xmlns=&quot;urn:schemas-microsoft-com:asm.v3&quot;&gt;</span><br><span class="line">    &lt;security&gt;</span><br><span class="line">      &lt;requestedPrivileges&gt;</span><br><span class="line">        &lt;requestedExecutionLevel level=&#x27;requireAdministrator&#x27; uiAccess=&#x27;false&#x27; /&gt;</span><br><span class="line">      &lt;/requestedPrivileges&gt;</span><br><span class="line">    &lt;/security&gt;</span><br><span class="line">  &lt;/trustInfo&gt;</span><br><span class="line">&lt;/assembly&gt;</span><br></pre></td></tr></table></figure>

<p>将新建的这个文件和你的应用程序放在一起，打开VS自带的“开发人员命令提示”工具，切换到你的这个文件目录下，输入下面的命令<br><code>mt.exe -manifest &quot;uac.manifest&quot; -outputresource:&quot;example.exe&quot;;#1</code></p>
<p>mt.exe为vs自带的工具，如果不知道在哪，用Everything 搜索一下就可以了。”example.exe” 为应用程序的名称</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.isroots.com/2024/07/22/QtBase%20%E5%BA%93%E5%AE%89%E8%A3%85/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="吴晓宁">
      <meta itemprop="description" content="记录一些自己的见闻">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吴晓宁blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/07/22/QtBase%20%E5%BA%93%E5%AE%89%E8%A3%85/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-07-22 14:40:30" itemprop="dateCreated datePublished" datetime="2024-07-22T14:40:30+08:00">2024-07-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li>以前工作中用到的 Qt 比较多，对一些常用的 API 也比较熟悉，对比 std 来说，QString 比 std:: string 好用太多了。在做一个后台程序的时候，想着能不能把 Qt 的库搬过来用，但 Qt 库相对来说比较臃肿，想着怎么精简下，就有了这次的折腾记录。</li>
<li>Qt在github上有个<a target="_blank" rel="noopener" href="https://github.com/qt/qtbase" title="qtBase">qtBase</a>里面只包含了Qt的基础东西,包含 QtCore,QWidget,gui,network等库。所以就把这个库clone 下来进行了编译和使用 。</li>
</ul>
<h3 id="下载和编译"><a href="#下载和编译" class="headerlink" title="下载和编译"></a>下载和编译</h3><ul>
<li>下载<br>  <code>https://github.com/qt/qtbase.git</code><br>  我当时用的是5.12版本的 ，下载完成后记得切换成 5.12版本 <code>get checkout 5.12</code>,然后对比着<code>configure_help.tex</code> 文件把一些不太需要的库去掉了，写了个配置文件，这个配置只针对5.12版本，这个配置文件应该是有问题的，当时只想着精简，只留下个core，把所有能去掉的都去了，到后面使用出现了问题。配置文件如下，后续还需要更改再试,如果需要交叉编译，则需要配置platform等，<code>configure_help</code>里面有说明。这里我编译成静态库来使用。</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">make clean</span></span><br><span class="line">echo &quot;------------- start-----------&quot;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">配置编译目录</span></span><br><span class="line">./configure -prefix /usr/local/qt/ \</span><br><span class="line">-release \</span><br><span class="line">-static \</span><br><span class="line">-opensource \</span><br><span class="line">-confirm-license \</span><br><span class="line">-c++std 11 \</span><br><span class="line">-sqlite \</span><br><span class="line">-no-accessibility \</span><br><span class="line">-nomake tests \</span><br><span class="line">-no-gui \</span><br><span class="line">-no-widgets \</span><br><span class="line">-no-openssl \</span><br><span class="line">-no-journald \</span><br><span class="line">-no-syslog \</span><br><span class="line">-no-gif \</span><br><span class="line">-no-libpng \</span><br><span class="line">-no-libjpeg \</span><br><span class="line">-no-openssl \</span><br><span class="line">-no-libproxy \</span><br><span class="line">-eventfd \</span><br><span class="line">-inotify \</span><br><span class="line">-no-slog2 \</span><br><span class="line">-no-pps \</span><br><span class="line">-pkg-config \</span><br><span class="line">-nomake examples \</span><br><span class="line">-no-ico \</span><br><span class="line"></span><br><span class="line">echo &quot;---------make--------&quot;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">gmake -j4 &amp;&amp; <span class="built_in">sudo</span> gmake install</span></span><br></pre></td></tr></table></figure>

<p>配置完成后用 gmake进行编译和安装就行。我这里安装到<code>/usr/local/qt</code> 目录下了。</p>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><ul>
<li>写一个简单的文件试了下</li>
</ul>
<p>main.cpp</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*** </span></span><br><span class="line"><span class="comment"> * @copyright: NING</span></span><br><span class="line"><span class="comment"> * @Date: 2021-09-14 09:33:48</span></span><br><span class="line"><span class="comment"> * @Author: WXN</span></span><br><span class="line"><span class="comment"> * @LastEditTime: 2021-09-14 17:25:07</span></span><br><span class="line"><span class="comment"> * @LastEditors:</span></span><br><span class="line"><span class="comment"> * @Description: </span></span><br><span class="line"><span class="comment"> * @FilePath: /qtProject/testlib/main.cpp</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QtCore/QObject&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QtCore/QString&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QtCore/QStringList&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QtCore/QVector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QtCore/QtDebug&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// class A:public QObject&#123;</span></span><br><span class="line"><span class="comment">//     Q_OBJECT</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//     public:</span></span><br><span class="line"><span class="comment">//     void toemitString() &#123;</span></span><br><span class="line"><span class="comment">//         emit toBstring(&quot;hello B&quot;);</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//     signals:</span></span><br><span class="line"><span class="comment">//     void toBstring(const QString&amp; str);</span></span><br><span class="line"><span class="comment">// &#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// class B:public QObject&#123;</span></span><br><span class="line"><span class="comment">//     Q_OBJECT</span></span><br><span class="line"><span class="comment">//     public slots:</span></span><br><span class="line"><span class="comment">//     void recvAsignals(const QString&amp; str) &#123;</span></span><br><span class="line"><span class="comment">//         std::cout&lt;&lt;str.toStdString()&lt;&lt;std::endl;</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">// &#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc,<span class="type">char</span>**argv)</span> </span>&#123;</span><br><span class="line">    QString str = <span class="string">&quot;hello Qt&quot;</span>;</span><br><span class="line">    std::cout&lt;&lt;str.<span class="built_in">toStdString</span>()&lt;&lt;std::endl;</span><br><span class="line">    <span class="function">QStringList <span class="title">sstr</span><span class="params">(str)</span></span>;</span><br><span class="line">    std::cout&lt;&lt; sstr.<span class="built_in">indexOf</span>(<span class="string">&quot;Q&quot;</span>)&lt;&lt;std::endl;</span><br><span class="line">    QVector&lt;<span class="type">int</span>&gt; vec;</span><br><span class="line">    vec.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">    vec.<span class="built_in">push_back</span>(<span class="number">2</span>);</span><br><span class="line">    vec.<span class="built_in">push_back</span>(<span class="number">3</span>);</span><br><span class="line">    vec.<span class="built_in">push_back</span>(<span class="number">4</span>);</span><br><span class="line">    vec.<span class="built_in">push_back</span>(<span class="number">5</span>);</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    foreach(i,vec) &#123;</span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;i;</span><br><span class="line">    &#125;</span><br><span class="line">    QMap&lt;QString,<span class="type">int</span>&gt; map;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// A a;</span></span><br><span class="line">    <span class="comment">// B b;</span></span><br><span class="line">    <span class="comment">//QObject::connect(&amp;a,SIGNAL(toBstring(const QString&amp;)),&amp;b,SLOT(recvAsignals(const QString&amp;)));</span></span><br><span class="line">    <span class="comment">//a.toemitString();</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>CmakeLists.txt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"># 项目名称</span><br><span class="line">project(demo)</span><br><span class="line"># cmake最低版本, Qt5要求最低3.1</span><br><span class="line">cmake_minimum_required(VERSION 3.1)</span><br><span class="line"># 指定编译器这个可要可不要</span><br><span class="line">set (CMAKE_CXX_COMPILER &quot;/opt/rh/devtoolset-8/root/usr/bin/g++&quot;)</span><br><span class="line">set(CMAKE_CXX_FLAGS &quot;-std=c++11 -Wno-deprecated-declarations  -fPIC&quot;)</span><br><span class="line"></span><br><span class="line">set(PROJECT_GEN_DIR $&#123;CMAKE_CURRENT_SOURCE_DIR&#125;)</span><br><span class="line"></span><br><span class="line"># 设置自动生成moc文件,AUTOMOC打开可以省去QT5_WRAP_CPP命令</span><br><span class="line">#set(CMAKE_AUTOMOC ON)</span><br><span class="line">#set(CMAKE_AUTORCC ON)</span><br><span class="line">#set(CMAKE_AUTOUIC ON)</span><br><span class="line">#if(CMAKE_VERSION VERSION_LESS &quot;3.7.0&quot;)</span><br><span class="line">#    set(CMAKE_INCLUDE_CURRENT_DIR ON)</span><br><span class="line">#endif()</span><br><span class="line"></span><br><span class="line"># 查找Qt头文件和库目录</span><br><span class="line">#set(QT_STATIC_PATH &quot;/usr/local/qt/lib&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">find_package(Qt5 COMPONENTS Core)</span><br><span class="line">find_package(ZLIB)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#include_directories($&#123;QT_STATIC_PATH&#125;/include</span><br><span class="line">#$&#123;QT_STATIC_PATH&#125;/include/QtCore</span><br><span class="line">#)</span><br><span class="line"></span><br><span class="line">aux_source_directory(./main.cpp SRC_LIST)</span><br><span class="line"></span><br><span class="line">link_directories($&#123;QT_STATIC_PATH&#125;/lib</span><br><span class="line">)</span><br><span class="line">SET(QT_LIBS libQt5Bootstrap.a libQt5Core.a ZLIB::ZLIB)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">set(EXECUTABLE_OUTPUT_PATH $&#123;PROJECT_GEN_DIR&#125;/bin)</span><br><span class="line">add_executable(demo main.cpp)</span><br><span class="line">message(&quot;project name flags is $&#123;PROJECT_NAME&#125;&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">target_link_libraries($&#123;PROJECT_NAME&#125;  $&#123;QT_LIBS&#125;)</span><br></pre></td></tr></table></figure>

<p><code>main.cpp</code> 中注释的代码是编译不过的代码，经过几天的测试和研究发现，应该是qt的库还引用了别的库，在写cmake的时候需要把别的库也引用上才可以，因为在cmake中如果不链接<code>zlib</code>库则QString 也没法使用。  </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.isroots.com/2024/07/22/Posix%E7%BA%BF%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="吴晓宁">
      <meta itemprop="description" content="记录一些自己的见闻">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吴晓宁blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/07/22/Posix%E7%BA%BF%E7%A8%8B/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-07-22 14:40:30" itemprop="dateCreated datePublished" datetime="2024-07-22T14:40:30+08:00">2024-07-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Posix线程"><a href="#Posix线程" class="headerlink" title="Posix线程"></a>Posix线程</h1><h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a><strong>目录</strong></h2><ul>
<li><p><a href="#Pthread-API">Pthread API</a></p>
<ul>
<li><a href="#Pthread-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B">Pthread 数据类型</a></li>
</ul>
</li>
<li><p><a href="#%E5%88%9B%E5%BB%BA%E7%BA%BF%E7%A8%8B">创建线程</a></p>
</li>
<li><p><a href="#%E7%BB%88%E6%AD%A2%E7%BA%BF%E7%A8%8B">终止线程</a></p>
</li>
<li><p><a href="#%E7%BA%BF%E7%A8%8BID">线程ID</a></p>
</li>
<li><p><a href="#%E8%BF%9E%E6%8E%A5joining%E5%B7%B2%E7%BB%88%E6%AD%A2%E7%9A%84%E7%BA%BF%E7%A8%8B">连接(joining)已终止的线程</a></p>
</li>
</ul>
<h3 id="Pthread-API"><a href="#Pthread-API" class="headerlink" title="Pthread API"></a><strong>Pthread API</strong></h3><h4 id="Pthread-数据类型"><a href="#Pthread-数据类型" class="headerlink" title="Pthread 数据类型"></a>Pthread 数据类型</h4><table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><strong>数据类型</strong></td>
<td><strong>描述</strong></td>
</tr>
<tr>
<td>pthread_t</td>
<td>线程ID</td>
</tr>
<tr>
<td>pthread_mutex_t</td>
<td>互斥对象(mutex_t)</td>
</tr>
<tr>
<td>pthread_mutexattr_t</td>
<td>互斥属性对象</td>
</tr>
<tr>
<td>pthread_cond_t</td>
<td>条件变量</td>
</tr>
<tr>
<td>pthread_condattr_t</td>
<td>条件变量的属性对象</td>
</tr>
<tr>
<td>pthread_key_t</td>
<td>线程特有数据的键</td>
</tr>
<tr>
<td>pthread_once_t</td>
<td>一次性初始化控制上下文</td>
</tr>
<tr>
<td>pthread_attr_t</td>
<td>线程的属性对象</td>
</tr>
</tbody></table>
<h3 id="创建线程"><a href="#创建线程" class="headerlink" title="创建线程"></a><strong>创建线程</strong></h3><p>pthread 函数均以返回0表示成功，返回一正值表示失败。创建线程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;pthread.h&gt;</span><br><span class="line">int pthread_create(pthread_t * thread,const pthread_arr_t* arr,void*(*start)(void*),void* arg)</span><br><span class="line">​</span><br><span class="line">pthread_t *thread;</span><br><span class="line">int s;</span><br><span class="line">s = pthread_create(&amp;thread,NULL,func,&amp;arg);</span><br><span class="line">if(s != 0)&#123;</span><br><span class="line">  printf(&quot;线程创建失败&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>📌欲要保持程序可移植性，则在任何将要运行该应用的实现中，正常退出线程的返回值应不同于相应的PTHREAD_CANCELED值。</p>
</blockquote>
<h3 id="终止线程"><a href="#终止线程" class="headerlink" title="终止线程"></a><strong>终止线程</strong></h3><p>NaN. 线程 start 函数执行return 语句并返回指定值</p>
<p>NaN. 线程调用 <code>pthread_exit()</code></p>
<p>NaN. 调用 <code>pthread_cancel()</code> 取消线程</p>
<p>NaN. 任意线程调用了<code>exit()</code> 或者主线程执行了return 语句（在main()）主函数中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">void pthread_exit(void * retval);</span><br><span class="line">// 参数retval 指定了线程的返回值，Retval 所指向的内容不应分配于线程栈中，因为线程终止后,将无法确定线程栈中的内容是否有效。</span><br><span class="line">​</span><br></pre></td></tr></table></figure>

<h3 id="线程ID"><a href="#线程ID" class="headerlink" title="线程ID"></a><strong>线程ID</strong></h3><p>线程ID会返回给<code>pthread_create()</code>的调用者，一个线程可以通过 <code>pthread_self()</code> 来获取自己的ID。</p>
<ul>
<li><p>不同的Pthreads函数利用线程ID来标识自己要操作的目标线程，这些函数包括<code>pthread_join()</code> <code>pthread_detach</code> <code>pthread_cancel</code> 和<code>pthread_kill</code> 等</p>
</li>
<li><p>在一些应用程序中，以特定线程的线程ID作为动态数据结构的标签，既可以用识别某个数据结构的创建者或者属主线程,又可以确定随后对该数据结构执行操作的具体线程</p>
</li>
</ul>
<p>函数<code>pthread_equal()</code> 可以检查两个线程ID是否相同</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int pthrad_equal(pthread_t t1,ptread_t t2);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>📌SUSv3并未要求将 pthread t实现为一个标量( scalar)类型,该类型也可以是一个结构 因此,下列显示线程D的代码实例并不具有可移植性(尽管该实例在包括 Linux在内的许多 实现上均可正常运行,而且有时在调试程序时还很实用)。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pthread_t thr;</span><br><span class="line">printf(Thread ID =%ld\n, (long) thr)</span><br><span class="line">/ WRONG! *</span><br></pre></td></tr></table></figure>

<h3 id="连接-joining-已终止的线程"><a href="#连接-joining-已终止的线程" class="headerlink" title="连接(joining)已终止的线程"></a><strong>连接(joining)已终止的线程</strong></h3><p>函数<code>pthread_join()</code>等待由thread标识的线程终止，</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">吴晓宁</p>
  <div class="site-description" itemprop="description">记录一些自己的见闻</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">39</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">吴晓宁</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
